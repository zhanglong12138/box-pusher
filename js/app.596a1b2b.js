(function(t){function e(e){for(var c,n,o=e[0],r=e[1],l=e[2],u=0,d=[];u<o.length;u++)n=o[u],Object.prototype.hasOwnProperty.call(s,n)&&s[n]&&d.push(s[n][0]),s[n]=0;for(c in r)Object.prototype.hasOwnProperty.call(r,c)&&(t[c]=r[c]);b&&b(e);while(d.length)d.shift()();return i.push.apply(i,l||[]),a()}function a(){for(var t,e=0;e<i.length;e++){for(var a=i[e],c=!0,o=1;o<a.length;o++){var r=a[o];0!==s[r]&&(c=!1)}c&&(i.splice(e--,1),t=n(n.s=a[0]))}return t}var c={},s={app:0},i=[];function n(e){if(c[e])return c[e].exports;var a=c[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=c,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var c in t)n.d(a,c,function(e){return t[e]}.bind(null,c));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/box-pusher/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],r=o.push.bind(o);o.push=e,o=o.slice();for(var l=0;l<o.length;l++)e(o[l]);var b=r;i.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"396f":function(t,e,a){"use strict";a("bcfb")},"56d7":function(t,e,a){"use strict";a.r(e);var c=a("7a23");a("e9f5"),a("ab43");const s={class:"container"};function i(t,e,a,i,n,o){const r=Object(c["l"])("BoxPusher"),l=Object(c["l"])("MapEditor");return Object(c["j"])(),Object(c["e"])("div",s,["default"==n.status?(Object(c["j"])(),Object(c["c"])(r,{key:0,ref:"stage",onChangestatus:o.changestatus,fmap:t.map,fstage:t.stage},null,8,["onChangestatus","fmap","fstage"])):Object(c["d"])("",!0),"edit"==n.status?(Object(c["j"])(),Object(c["c"])(l,{key:1,onChangestatus:o.changestatus,onPlay:o.play},null,8,["onChangestatus","onPlay"])):Object(c["d"])("",!0)])}const n={class:"container"},o={class:"menu"},r={class:"stage"},l={class:"win"};function b(t,e,a,s,i,b){return Object(c["j"])(),Object(c["e"])("div",n,[Object(c["f"])("div",o,[Object(c["f"])("nav",{class:"navbtn",onClick:e[0]||(e[0]=(...t)=>b.changestatus&&b.changestatus(...t)),"data-key":"default"},"Play"),Object(c["f"])("nav",{class:"navbtn",onClick:e[1]||(e[1]=(...t)=>b.changestatus&&b.changestatus(...t)),"data-key":"edit"},"Edit map by yourself"),Object(c["f"])("nav",{class:"navbtn",onClick:e[3]||(e[3]=(...t)=>b.importmap&&b.importmap(...t))},[e[5]||(e[5]=Object(c["h"])("Import maps ",-1)),Object(c["p"])(Object(c["f"])("input",{type:"file",id:"upload",onChange:e[2]||(e[2]=(...t)=>b.uploaded&&b.uploaded(...t))},null,544),[[c["o"],!1]])]),Object(c["f"])("nav",{class:"navbtn",onClick:e[4]||(e[4]=(...t)=>b.share&&b.share(...t))},"Share Box-pusher!")]),Object(c["f"])("div",r,[Object(c["p"])(Object(c["f"])("div",l,null,512),[[c["o"],i.show]]),(Object(c["j"])(!0),Object(c["e"])(c["a"],null,Object(c["k"])(i.active_map,(t,e)=>(Object(c["j"])(),Object(c["e"])("div",{class:"row",key:e},[(Object(c["j"])(!0),Object(c["e"])(c["a"],null,Object(c["k"])(t,(t,e)=>(Object(c["j"])(),Object(c["e"])("div",{class:Object(c["i"])(["block",b.getBlock(t)]),key:e},null,2))),128))]))),128))])])}a("14d9"),a("2c66"),a("249d"),a("40e9"),a("907a"),a("986a"),a("1d02"),a("3c5d"),a("6ce5"),a("2834"),a("4ea1"),a("61ae"),a("0a00"),a("b6f3"),a("4801");var u={name:"BoxPusher",props:{fmap:{type:Array,default(){return[0,0,0,0,0,0,0,2,1,1,1,0,0,1,3,3,1,0,0,1,1,0,0,0,0,1,1,1,4,0,0,1,1,1,4,0,0,0,0,0,0,0]}},fstage:{type:Array,default(){return[6,7]}}},data(){return{static_map:[],active_map:[],key2direction:{87:1,38:1,83:2,40:2,65:3,37:3,68:4,39:4},key_arr:[87,38,83,40,65,37,68,39],show:!1}},beforeCreate(){var t=this;window.onkeydown=function(e){t.move(e.keyCode)}},created(){this.map=d(this.fmap),this.stage=d(this.fstage),this.map_init()},mounted(){},computed:{player_position(){for(let t in this.active_map)for(let e in this.active_map[t])if(2===this.active_map[t][e])return[this.static_map[t][e],+t,+e];return[0,0]},complete_count(){let t=0;for(let e in this.active_map)for(let a in this.active_map[e])3===this.active_map[e][a]&&4===this.static_map[e][a]&&t++;return t}},methods:{map_init(){this.map.length!=this.stage[0]*this.stage[1]&&alert("map data error");let t=[];for(let e=0;e<this.stage[1];e++)t.push(this.map.slice(e*this.stage[0],(e+1)*this.stage[0]));this.static_map=d(t),this.active_map=d(t),this.box_count=this.calc_block(3)},importmap(){document.getElementById("upload").click()},uploaded(t){var e=this,a=t.target.files,c=a[0],s=new FileReader;s.onload=function(t){let a=new Uint8Array(t.target.result),c=new TextDecoder("gb2312").decode(a),s=JSON.parse(c);e.map=s.map,e.stage=s.stage,e.map_init()},s.readAsArrayBuffer(c)},share(){alert("Functions is coming! Thanks so much!")},changestatus(t){this.$emit("changestatus",t)},congratulations(){this.show=!0},calc_block(t){let e=0;for(let a in this.map)this.map[a]===t&&e++;return e},getNextblock(t,e,a,c=1){return 1==t?[this.active_map[e-c][a],e-c,a]:2==t?[this.active_map[e+c][a],e+c,a]:3==t?[this.active_map[e][a-c],e,a-c]:4==t?[this.active_map[e][a+c],e,a+c]:void 0},move(t){let e=this.key_arr.indexOf(t);if(-1==e)return;let a=this.key2direction[""+t],[c,s,i]=this.player_position,[n,o,r]=this.getNextblock(a,s,i);switch(n){case 4:case 1:this.active_map[o][r]=2,this.active_map[s][i]=4==c?4:1;break;case 3:{let[t,e,n]=this.getNextblock(a,s,i,2);[1,4].indexOf(t)>-1&&(this.active_map[e][n]=3,this.active_map[o][r]=2,this.active_map[s][i]=4==c?4:1);break}}this.complete_count==this.box_count&&this.congratulations()},getBlock(t){return["stone","back","player","box","dream","complete"][t]}}};function d(t){let e=Array.isArray(t)?[]:{};if(t&&"object"===typeof t)for(let a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t&&"object"===typeof t[a]?d(t[a]):t[a]);return e}a("396f");var p=a("6b0d"),h=a.n(p);const v=h()(u,[["render",b],["__scopeId","data-v-e13ec61c"]]);var f=v;const m={class:"container"},j={class:"menu"},O={class:"stage"},k={class:"para"},g={class:"para"},y={class:"para"},_={key:0,class:"editable"},w={class:"initData"},x={class:"map"},C=["onClick"];function P(t,e,a,s,i,n){return Object(c["j"])(),Object(c["e"])("div",m,[Object(c["f"])("div",j,[Object(c["f"])("nav",{class:"navbtn",onClick:e[0]||(e[0]=(...t)=>n.changestatus&&n.changestatus(...t)),"data-key":"default"},"Return"),i.show?(Object(c["j"])(),Object(c["e"])("nav",{key:0,class:"navbtn",onClick:e[1]||(e[1]=t=>i.show=!1)},"Reset init data")):Object(c["d"])("",!0),i.show?(Object(c["j"])(),Object(c["e"])("nav",{key:1,class:"navbtn",onClick:e[2]||(e[2]=(...t)=>n.save&&n.save(...t))},"Save & Output your map")):Object(c["d"])("",!0),i.show?(Object(c["j"])(),Object(c["e"])("nav",{key:2,class:"navbtn",onClick:e[3]||(e[3]=(...t)=>n.playnow&&n.playnow(...t))},"Play it right now")):Object(c["d"])("",!0)]),Object(c["f"])("div",O,[Object(c["p"])(Object(c["f"])("div",null,[Object(c["f"])("div",k,[e[8]||(e[8]=Object(c["f"])("label",{for:"x"},"row block：",-1)),Object(c["p"])(Object(c["f"])("input",{type:"number",id:"x","onUpdate:modelValue":e[4]||(e[4]=t=>i.stage[0]=t)},null,512),[[c["n"],i.stage[0]]])]),Object(c["f"])("div",g,[e[9]||(e[9]=Object(c["f"])("label",{for:"y"},"column block：",-1)),Object(c["p"])(Object(c["f"])("input",{type:"number",id:"y","onUpdate:modelValue":e[5]||(e[5]=t=>i.stage[1]=t)},null,512),[[c["n"],i.stage[1]]])]),Object(c["f"])("div",y,[e[10]||(e[10]=Object(c["f"])("label",{for:"count"},"box counts：",-1)),Object(c["p"])(Object(c["f"])("input",{type:"number",id:"count","onUpdate:modelValue":e[6]||(e[6]=t=>i.box_count=t)},null,512),[[c["n"],i.box_count]])]),Object(c["f"])("button",{class:"initbtn",onClick:e[7]||(e[7]=(...t)=>n.init&&n.init(...t))},"Init my map")],512),[[c["o"],!i.show]]),i.show?(Object(c["j"])(),Object(c["e"])("div",_,[Object(c["f"])("div",w,[Object(c["h"])(" row block："+Object(c["m"])(i.stage[0])+" ",1),e[11]||(e[11]=Object(c["f"])("br",null,null,-1)),Object(c["h"])(" column block："+Object(c["m"])(i.stage[1])+" ",1),e[12]||(e[12]=Object(c["f"])("br",null,null,-1)),Object(c["h"])(" box counts："+Object(c["m"])(i.box_count),1)]),Object(c["f"])("div",x,[(Object(c["j"])(!0),Object(c["e"])(c["a"],null,Object(c["k"])(i.static_map,(t,e)=>(Object(c["j"])(),Object(c["e"])("div",{class:"row",key:e},[(Object(c["j"])(!0),Object(c["e"])(c["a"],null,Object(c["k"])(t,(t,a)=>(Object(c["j"])(),Object(c["e"])("div",{class:Object(c["i"])(["block",n.getBlock(t),a==i.active_position[0]&&e==i.active_position[1]?"active":""]),key:a,onClick:t=>i.active_position=[a,e]},null,10,C))),128))]))),128))]),e[13]||(e[13]=Object(c["g"])('<div class="tips" data-v-7c8db42c> 1. Clicking at the block or pressing the keybroad with &quot;w,s,a,d&quot; to select editable block. <br data-v-7c8db42c> 2.Inputing numbers with the keys &quot;0-4&quot; to change the block function status. <br data-v-7c8db42c> 3.The box-counts must be equal to that before setting. </div><div class="iconlist" data-v-7c8db42c><div class="block stone" data-v-7c8db42c></div><div class="block back" data-v-7c8db42c></div><div class="block player" data-v-7c8db42c></div><div class="block box" data-v-7c8db42c></div><div class="block dream" data-v-7c8db42c></div></div><div class="iconlist" data-v-7c8db42c><div class="block" data-v-7c8db42c>0</div><div class="block" data-v-7c8db42c>1</div><div class="block" data-v-7c8db42c>2</div><div class="block" data-v-7c8db42c>3</div><div class="block" data-v-7c8db42c>4</div></div>',3))])):Object(c["d"])("",!0)])])}a("88a7"),a("271a"),a("5494");var B={name:"MapEditor",data(){return{static_map:[],stage:[6,7],box_count:2,keys:{87:1,38:1,83:2,40:2,65:3,37:3,68:4,39:4,48:0,96:0,97:-1,49:-1,98:-2,50:-2,99:-3,51:-3,100:-4,52:-4},key_arr:[87,38,83,40,65,37,68,39,49,50,51,52,53,96,97,98,99,100,48,96],active_position:[1,1],show:!1}},beforeCreate(){},created(){var t=this;window.onkeydown=function(e){t.keypress(e.keyCode)}},mounted(){},computed:{},methods:{changestatus(t){this.$emit("changestatus",t)},playnow(){this.singlecheckmap()&&this.$emit("play",{map:this.getstaticmap(),stage:[...this.stage]})},save(){var t={map:this.getstaticmap(),stage:[...this.stage]};if(this.singlecheckmap()){var e=document.createElement("a"),a=new Blob([JSON.stringify(t)]);e.download="box-pusher.map.json",e.href=URL.createObjectURL(a),e.click(),URL.revokeObjectURL(a),e=null}},singlecheckmap(){let t=0,e=0,a=this.getstaticmap();for(let c in a)3===a[c]&&(t+=1),4===a[c]&&(e+=1);return t!==this.box_count?(alert("Error:box_count incorrect!"),!1):e!==this.box_count?(alert("Error:flag_count incorrect!"),!1):!!a.includes(2)||(alert("Error:no player.Keypress 2 to set player!"),!1)},getstaticmap(){return[].concat(...this.static_map)},init(){let[t,e]=this.stage,a=[];for(let c=0;c<e;c++)if(0==c||c==e-1)a.push(new Array(t).fill(0));else{let e=new Array(t).fill(1);e[0]=0,e[t-1]=0,a.push(e)}this.static_map=a,this.show=!0},keypress(t){if(!this.show)return;let e=this.key_arr.indexOf(t);if(-1==e)return;let a=this.keys[""+t];if("undefined"!=a)switch(a){case 1:this.active_position[1]>0&&this.active_position[1]--;break;case 2:this.active_position[1]<this.stage[1]-1&&this.active_position[1]++;break;case 3:this.active_position[0]>0&&this.active_position[0]--;break;case 4:this.active_position[0]<this.stage[0]-1&&this.active_position[0]++;break;case 0:case-1:case-2:case-3:case-4:case-5:this.setBlock(this.active_position[1],this.active_position[0],-a);break;default:break}},setBlock(t,e,a){if(2==a){let t=this.getstaticmap().indexOf(2);if(t>-1)for(let e in this.static_map)for(let t in this.static_map[e])if(2===this.static_map[e][t]){this.static_map[e][t]=1;break}}this.static_map[t][e]=a},getBlock(t){return["stone","back","player","box","dream","complete"][t]}}};a("c17b");const A=h()(B,[["render",P],["__scopeId","data-v-7c8db42c"]]);var E=A,S={map:[0,0,0,0,0,0,0,2,1,1,1,0,0,1,3,3,1,0,0,1,1,0,0,0,0,1,1,1,4,0,0,1,1,1,4,0,0,0,0,0,0,0],stage:[6,7]},U={data(){return{status:"default"}},mixins:[S],name:"App",components:{BoxPusher:f,MapEditor:E},methods:{changestatus(t){this.status=t.currentTarget.dataset.key},play(t){this.map=t.map,this.stage=t.stage,this.status="default"}}};a("b70d");const M=h()(U,[["render",i]]);var R=M;Object(c["b"])(R).mount("#app")},a1d0:function(t,e,a){},b70d:function(t,e,a){"use strict";a("a1d0")},bcfb:function(t,e,a){},c17b:function(t,e,a){"use strict";a("f69e")},f69e:function(t,e,a){}});
//# sourceMappingURL=app.596a1b2b.js.map